

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hich Configuration Basics &mdash; Hich 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8ea2664f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Single Sample" href="single_sample.html" />
    <link rel="prev" title="Vignettes" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Hich
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Vignettes</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hich Configuration Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-hich">Running Hich</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-samplefile-option">The <code class="docutils literal notranslate"><span class="pre">--sampleFile</span></code> option</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-params-file-option">The <code class="docutils literal notranslate"><span class="pre">-params-file</span></code> option</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-profile-option-and-nextflow-config">The <code class="docutils literal notranslate"><span class="pre">-profile</span></code> option and <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code></a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="single_sample.html">Single Sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorial.html">Factorial Experiment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workflow_steps/index.html">Workflow Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../planning/index.html">Planning The Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementation/index.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../next_steps/index.html">Next Steps After Running Hich</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Hich</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Vignettes</a></li>
      <li class="breadcrumb-item active">Hich Configuration Basics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/vignettes/basics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hich-configuration-basics">
<h1>Hich Configuration Basics<a class="headerlink" href="#hich-configuration-basics" title="Link to this heading"></a></h1>
<section id="running-hich">
<h2>Running Hich<a class="headerlink" href="#running-hich" title="Link to this heading"></a></h2>
<p>This command executes a <strong>stub run</strong> of a preconfigured vignette. A stub run, specified below with <cite>-stub-run</cite>, downloads containers and stages references if needed, but no further processing. Instead, it executes a stub section of each process. This quickly confirms which processes will be run.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">nextflow</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">contents</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">nf</span><span class="w"> </span><span class="o">-</span><span class="n">stub</span><span class="o">-</span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">sampleFile</span><span class="w"> </span><span class="n">vignettes</span><span class="o">/</span><span class="n">akgol2021</span><span class="o">/</span><span class="n">one_rep_bwa</span><span class="p">.</span><span class="n">tsv</span><span class="w"> </span><span class="o">-</span><span class="n">params</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="n">params</span><span class="o">/</span><span class="n">onerep_bulk</span><span class="p">.</span><span class="n">yml</span><span class="w"> </span><span class="o">-</span><span class="n">profile</span><span class="w"> </span><span class="n">localPC</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">`nextflow</span> <span class="pre">run</span> <span class="pre">contents/main.nf`</span></code> runs Hich. The <code class="docutils literal notranslate"><span class="pre">--sampleFile</span></code> option specifies a file containing input files and parameters for each individual sample. The <code class="docutils literal notranslate"><span class="pre">-params-file</span></code> option loads options from a YAML file that offers more comprehensive control over default and integrative sample processing, such as aggregation and feature calling. The <code class="docutils literal notranslate"><span class="pre">-profile</span></code> option adapts the run to use resources appropriate to the machine, with different profiles specified in <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code>.</p>
</section>
<section id="the-samplefile-option">
<h2>The <code class="docutils literal notranslate"><span class="pre">--sampleFile</span></code> option<a class="headerlink" href="#the-samplefile-option" title="Link to this heading"></a></h2>
<p>This is a simple example of a sample file, which can be found in vignettes/akgol2021/one_rep_bwa.tsv. The experimental condition is labeled in <code class="docutils literal notranslate"><span class="pre">condition</span></code>. We will demonstrate using <code class="docutils literal notranslate"><span class="pre">techrep</span></code> and <code class="docutils literal notranslate"><span class="pre">biorep</span></code> columns for factorial designs later. The two input <code class="docutils literal notranslate"><span class="pre">fastq</span></code> files are listed at <code class="docutils literal notranslate"><span class="pre">fastq</span></code> and <code class="docutils literal notranslate"><span class="pre">fastq2</span></code>. The <code class="docutils literal notranslate"><span class="pre">assembly</span></code>, <code class="docutils literal notranslate"><span class="pre">aligner</span></code> and <code class="docutils literal notranslate"><span class="pre">restrictionEnzymes</span></code> are specified as well. Hich can automatically download the genome reference for hg38 and several other commonly-used references from the NCBI database and use it to produce a chromsizes file, aligner index, and fragment index. These will be hard linked in the <code class="docutils literal notranslate"><span class="pre">resources</span></code> subdirectory and can be reused for other projects.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>condition</p></th>
<th class="head"><p>fastq1</p></th>
<th class="head"><p>fastq2</p></th>
<th class="head"><p>assembly</p></th>
<th class="head"><p>aligner</p></th>
<th class="head"><p>restrictionEnzymes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Formaldehyde+DSG_DdeI_and_DpnII_HFFc6</p></td>
<td><p>vignettes/akgol2021/downsampled/Formaldehyde+DSG_DdeI_and_DpnII_HFFc6_BR1_TR1_R1.fastq.gz</p></td>
<td><p>vignettes/akgol2021/downsampled/Formaldehyde+DSG_DdeI_and_DpnII_HFFc6_BR1_TR1_R2.fastq.gz</p></td>
<td><p>hg38</p></td>
<td><p>bwa</p></td>
<td><p>DdeI,DpnII</p></td>
</tr>
</tbody>
</table>
<p>If required resource files are already available, they can be specified in the sample file as well, although the <code class="docutils literal notranslate"><span class="pre">assembly</span></code> and <code class="docutils literal notranslate"><span class="pre">restrictionEnzymes</span></code> parameters should still be specified.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>genomeReference</p></th>
<th class="head"><p>chromsizes</p></th>
<th class="head"><p>aligner</p></th>
<th class="head"><p>alignerIndexDir</p></th>
<th class="head"><p>alignerIndexPrefix</p></th>
<th class="head"><p>fragmentIndex</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>resources/hich/genomeReference/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta.gz</p></td>
<td><p>resources/hich/chromsizes/hg38.sizes</p></td>
<td><p>bwa</p></td>
<td><p>resources/hich/bwa/bwa/index</p></td>
<td><p>hg38</p></td>
<td><p>resources/hich/fragmentIndex/hg38_DdeI_DpnII.bed</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-params-file-option">
<h2>The <code class="docutils literal notranslate"><span class="pre">-params-file</span></code> option<a class="headerlink" href="#the-params-file-option" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">-params-file</span></code> is a YAML file for configuring default attribute values applying to all samples, as well as how to aggregate and call features on samples. Hich provides several preconfigured YAML files for different purposes in the <code class="docutils literal notranslate"><span class="pre">params</span></code> subdirectory. Parameters can be specified in the <cite>-params-file</cite> to control sample aggregation, including downsampling, merging and deduplication.</p>
<p>The default section specifies sample attributes that will be applied unless overridden by a column of the same name in the sample file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">defaults</span><span class="p">:</span>
<span class="w">    </span><span class="nl">techrep</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="nl">biorep</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="nl">minMapq</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span>
<span class="w">    </span><span class="nl">aligner</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bwa-mem2&quot;</span>
<span class="w">    </span><span class="nl">bwaFlags</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;-SP5M&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nl">reshapeParams</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="nl">globalDefaultReshapeToCellID</span><span class="p">:</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">option</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;--regex&quot;</span>
<span class="w">        </span><span class="nl">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^(.*?):.*&quot;</span>
<span class="w">        </span><span class="nl">group</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nl">pairtoolsParse2Params</span><span class="p">:</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;--drop-readid&quot;</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;--drop-seq&quot;</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="s">&quot;--drop-sam&quot;</span>
<span class="w">    </span><span class="nl">pairtoolsDedupParams</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="nl">pairtoolsSelectParams</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="nl">pairtoolsSelectFilters</span><span class="p">:</span>
<span class="w">        </span><span class="nl">keepPairTypes</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;UU&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RU&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UR&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nl">keepTrans</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">keepCis</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">minDistFR</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="nl">minDistRF</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="nl">minDistFF</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="nl">minDistRR</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">        </span><span class="nl">discardSingleFrag</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">    </span><span class="nl">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="nl">makeMcoolFileFormat</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">makeHicFileFormat</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">resolutions</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="mi">20000</span><span class="p">,</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span><span class="w"> </span><span class="mi">200000</span><span class="p">,</span><span class="w"> </span><span class="mi">500000</span><span class="p">,</span><span class="w"> </span><span class="mi">1000000</span><span class="p">]</span>
<span class="w">    </span><span class="nl">juicerToolsPreParams</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="nl">coolerCloadParams</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;--chrom1 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--pos1 3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--chrom2 4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--pos2 5&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nl">coolerZoomifyParams</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;--balance&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--balance-args &#39;--max-iters 2000 --trans-only&#39;&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Samples can be downsampled, merged and deduplicated using the aggregate block. Here, <code class="docutils literal notranslate"><span class="pre">fullCoverageDedup</span></code> is the name of a simple aggregate profile that deduplicates samples, merging as in the workflow diagram above. No downsampling or merging occurs. Multiple and more complex aggregate profiles can be created and each sample it applies to will be cloned and labeled with the aggregate profile as well as its condition, biorep and techrep.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">aggregate</span><span class="p">:</span>
<span class="w">    </span><span class="nl">fullCoverageDedup</span><span class="p">:</span>
<span class="w">        </span><span class="nl">dedupMaxMismatch</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="nl">dedupMethod</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;max&quot;</span>
<span class="w">        </span><span class="nl">techrepDedup</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">mergeTechrepToBiorep</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
<span class="w">        </span><span class="nl">mergeBiorepToCondition</span><span class="p">:</span><span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
<p>Multiple samples can be specified for different conditions, biological and technical replicates. Below is part of a demo sample file which specifies 8 samples. The fullCoverageDedup aggregate profile will merge them as in the workflow diagram.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>condition</p></th>
<th class="head"><p>biorep</p></th>
<th class="head"><p>techrep</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Condition1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Condition1</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Condition1</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Condition1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Condition2</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Condition2</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Condition2</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Condition2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</td>
<td><img alt="../_images/merge_samples.png" src="../_images/merge_samples.png" />
</td>
</tr>
</tbody>
</table>
<p>Some Hich features involve combinatorial comparisons between samples or feature calling parameters. To focus the comparisons on those most useful for the analysis, Hich allows defining <strong>sample selection strategies.</strong> These are given names, like <code class="docutils literal notranslate"><span class="pre">demo_strategy</span></code> below. Under the name of the sample selection strategy, keys (like <code class="docutils literal notranslate"><span class="pre">condition</span></code>) specify the name of sample attributes and values (like <code class="docutils literal notranslate"><span class="pre">[&quot;Condition1&quot;,</span> <span class="pre">&quot;Condition2&quot;]</span></code>) specify the set of acceptable values the sample must have to match that sample selection strategy. In this case, the sample’s condition must be either <code class="docutils literal notranslate"><span class="pre">&quot;Condition1&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Condition2&quot;</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">sampleSelectionStrategies</span><span class="p">:</span>
<span class="w">    </span><span class="nl">demo_strategy</span><span class="p">:</span>
<span class="w">        </span><span class="nl">condition</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Condition1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Condition2&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>One of Hich’s features is to call compartments. Compartment-calling profiles can be set up in the <code class="docutils literal notranslate"><span class="pre">compartments</span></code> block. You can see a default profile to call them at 10kb resolution. Only samples matching <code class="docutils literal notranslate"><span class="pre">demo_strategy</span></code> will be used for this profile.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">compartments</span><span class="p">:</span>
<span class="w">    </span><span class="nl">hich_compartments_default</span><span class="p">:</span>
<span class="w">        </span><span class="nl">sampleSelectionStrategy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;demo_strategy&quot;</span>
<span class="w">        </span><span class="nl">resolution</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span>
</pre></div>
</div>
</section>
<section id="the-profile-option-and-nextflow-config">
<h2>The <code class="docutils literal notranslate"><span class="pre">-profile</span></code> option and <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code><a class="headerlink" href="#the-profile-option-and-nextflow-config" title="Link to this heading"></a></h2>
<p>Using a container management system, such as docker, singularity or apptainer, is critical for Hich. Nextflow supports many container management systems. Your institution’s computational infrastructure may have a container management system pre-installed. Whichever container management system is to be used can be enabled in the nextflow.config file. Config parameters not typically expected to change between runs of Hich are also specified in nextflow.config.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">apptainer</span><span class="p">.</span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">general</span></code> section of the <code class="docutils literal notranslate"><span class="pre">nextflow.config</span></code> file specifies the location of containers necessary for Hich to run on Docker Hub. The necessary container files will be automatically downloaded and converted to the required container management system as Hich runs. The directories where Hich outputs will be published are specified in the publish subsection. Hich produces read-level MultiQC reports after certain processing steps specified in qcAfter. The <code class="docutils literal notranslate"><span class="pre">sampleFileSep</span></code> param controls the csv separator for the sample file. The <code class="docutils literal notranslate"><span class="pre">humidDefault</span></code> parameter is used during humid runs, where input fastq files are automatically downsampled to this number of reads prior to alignment to facilitate running the processing steps on a small input.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sampleFileSep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span>
<span class="w">    </span><span class="n">humidDefault</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100000</span>

<span class="w">    </span><span class="n">general</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">hichContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bskubi/hich:latest&quot;</span>
<span class="w">        </span><span class="n">chromsizesContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;quay.io/biocontainers/ucsc-fasize:332--0&quot;</span>
<span class="w">        </span><span class="n">mustacheContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bskubi/mustache:latest&quot;</span>
<span class="w">        </span><span class="n">juicerContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bskubi/juicer_tools:1.22.01&quot;</span>
<span class="w">        </span><span class="n">hictkContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ghcr.io/paulsengroup/hictk:1.0.0&quot;</span>

<span class="w">        </span><span class="n">publish</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;link&quot;</span>

<span class="w">            </span><span class="n">genomeReference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/genomeReference&quot;</span>
<span class="w">            </span><span class="n">chromsizes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/chromsizes&quot;</span>
<span class="w">            </span><span class="n">bwaMem2Index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/bwa-mem2&quot;</span>
<span class="w">            </span><span class="n">bwaIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/bwa&quot;</span>
<span class="w">            </span><span class="n">bsboltIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/bsbolt&quot;</span>
<span class="w">            </span><span class="n">fragmentIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;resources/hich/fragmentIndex&quot;</span>

<span class="w">            </span><span class="n">align</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/align&quot;</span>
<span class="w">            </span><span class="n">parse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/pairs/parse&quot;</span>
<span class="w">            </span><span class="n">dedup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/pairs/dedup&quot;</span>
<span class="w">            </span><span class="n">mcool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/matrix/mcool&quot;</span>
<span class="w">            </span><span class="n">hic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/matrix/hic&quot;</span>
<span class="w">            </span><span class="n">pairStats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/pairStats&quot;</span>
<span class="w">            </span><span class="n">qc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;results/qc&quot;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">qcAfter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;parse&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;ingestPairs&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;tagRestrictionFragments&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;deduplicate&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s">&quot;select&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Multiple resource profiles are defined as well. Nextflow does not actually monitor CPU or RAM usage by processes. Instead, an estimate is manually made of process resource requirements and Nextflow will ensure this estimate does not exceed the maximum specified for the profile.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">profiles</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">localPC</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;local&quot;</span>
<span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.</span><span class="n">GB</span>
<span class="w">        </span><span class="n">process</span><span class="p">.</span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;local&quot;</span>

<span class="w">        </span><span class="n">process</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">whenLocal_allConsuming</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">maxForks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">smallResource</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">pairs</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">8.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">createMatrix</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">16.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">convertMcoolToHic</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">convertHicToMcool</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nl">withLabel</span><span class="p">:</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">                </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.</span><span class="n">GB</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Vignettes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="single_sample.html" class="btn btn-neutral float-right" title="Single Sample" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Benjamin Skubi, Andrew Adey, Galip Gürkan Yardımcı.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>