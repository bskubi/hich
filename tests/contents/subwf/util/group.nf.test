nextflow_workflow {

    name "Test Workflow group.nf"
    script "contents/subwf/util/group.nf"
    

    test("groupAsColumns") {
        workflow "GroupAsColumns"

        when {
            workflow {
                """
                input[0] = Channel.of([a: 1, b: 1, id: 2], [a: 1, b: 2, id: 1], [a: 2, b: 3, id: 3])
                input[1] = ["a"]
                input[2] = ["id"]
                input[3] = [:]
                """
            }
        }

        then {
            with (workflow) {
                assert success
                def expected = [
                    [a: [1, 1], b: [2, 1], id: [1, 2]],
                    [a: [2], b: [3], id: [3]]
                ]
                assertContainsInAnyOrder(out.chan, expected)
            }
        }
    }
}
