nextflow_process {

    name "Test Process BwaMemIndex"
    script "contents/subwf/resources/processes/bwaMemIndex.nf"
    process "BwaMemIndex"

    test("stubBwaMemIndex") {
        options """-stub-run"""
        tag "priority1"

        when {
            params {
            }
            process {
                """
                input[0] = tuple("hg38", file("$projectDir/resources/hich/genomeReference/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta.gz"), "hg38")
                """
            }
        }

        then {
            assert process.success
            with (process) {
                def out = out[0][0]
                assert out[0] == "hg38"
                assert out[1].endsWith("/bwa/index")
                assert out[2] == "hg38"
                assert out[3].endsWith("/bwa/index/hg38.ann")
                assert out[4].endsWith("/bwa/index/hg38.amb")
                assert out[5].endsWith("/bwa/index/hg38.pac")
                assert out[6].endsWith("/bwa/index/hg38.bwt")
                assert out[7].endsWith("/bwa/index/hg38.sa")
            }
        }
    }
}
