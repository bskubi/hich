# Use an official Python runtime as a parent image
FROM python:3.9-slim

# Set the working directory in the container
WORKDIR /usr/src/app

# Install system packages required by pairtools and its dependencies
RUN apt-get update && apt-get install -y \
    build-essential \
    libbz2-dev \
    liblzma-dev \
    zlib1g-dev \
    libncurses5-dev \
    libncursesw5-dev \
    libcurl4-openssl-dev \
    libssl-dev \
    wget \
    samtools \
    lz4

# Cleanup to reduce image size
RUN apt-get clean && rm -rf /var/lib/apt/lists/*

# Install Python packages
RUN pip install --no-cache-dir numpy>=1.10 \
    pysam>=0.15.0 \
    cython \
    bioframe>=0.3.3 \
    pyyaml \
    scipy>=1.7.0 \
    pandas>=1.3.4 \
    click>=6.6

# Install pairtools
RUN pip install --no-cache-dir pairtools

# Make port 80 available to the world outside this container
EXPOSE 80

# Define environment variable
ENV NAME pairtools

# Run pairtools when the container launches
CMD ["pairtools"]

